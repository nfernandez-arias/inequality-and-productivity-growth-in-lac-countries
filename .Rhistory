facet_wrap(~ alpha3, ncol = 4) +
theme(legend.position = "bottom")
ggsave("figures/rgdpnaGrowth_LAC_countryCases.pdf", plot = last_plot(), width = 9, height = 6.5, units = "in")
##### Construct cumulative growth variables
pwt_7 <- pwt[ year == 2017 | year == 2010 | year == 2003 | year == 1996 | year == 1989 | year == 1982 | year == 1975 | year == 1968]
pwt_7[ , cumulativeTFP := cumsum(lrtfpna_chg7) / 8, by = .(alpha3)]
pwt_7[ , cumulativeNonTFP := cumsum(lrgdpnaPerCapita_chg7_nonTFP) / 8, by = .(alpha3)]
#pwt_7[ , cumulativeTFPcorrected := cumsum(lrtfpna_chg7 * 1.4) / 8, by = .(alpha3)]
#pwt_7[ , cumulativeNonTFPcorrected := cumsum(lrgdpnaPerCapita_chg7_nonTFP / 1.4) / 8, by = .(alpha3)]
pwt_7[ year >= 1996, post1990 := 1]
pwt_7[ is.na(post1990) , post1990 := 0]
pwt_7[ , cumulativeTFP1990 := cumsum(lrtfpna_chg7 * post1990) / 4, by = .(alpha3)]
pwt_7[ , cumulativeNonTFP1990 := cumsum(lrgdpnaPerCapita_chg7_nonTFP * post1990) / 4, by = .(alpha3)]
last_obs <- pwt_7[ , .SD[.N ], by = .(alpha3)]
### Make scatter plot version of Table 1 for whole world not just LAC
ggplot(last_obs, aes(x = cumulativeTFP, y = cumulativeNonTFP, color = subRegion_new)) +
#geom_point(size = 0, shape = 1) +
geom_text(aes(label = alpha3), size = 2) +
labs(title = "Decomposition of per capita output growth worldwide ") +
labs(subtitle = "1962-2017, annualized, %") +
labs( x= "Average RTFPNA growth", y = "Average non-RTFPNA RGDPNA / capita growth", color = "Legend") +
geom_abline(slope = 1, linetype = 2, size = 0.4) +
geom_abline(slope = -1, intercept = -1, size = 0.4, linetype = 3) +
geom_abline(slope = -1, intercept = 0, size = 0.4, linetype = 3) +
geom_abline(slope = -1, intercept = 1, size = 0.4, linetype = 3) +
geom_abline(slope = -1, intercept = 2, size = 0.4, linetype = 3) +
geom_abline(slope = -1, intercept = 3, size = 0.4, linetype = 3) +
geom_abline(slope = -1, intercept = 4, size = 0.4, linetype = 3) +
geom_abline(slope = -1, intercept = 5, size = 0.4, linetype = 3) +
geom_abline(slope = -1, intercept = 6, size = 0.4, linetype = 3) +
geom_vline(xintercept = 0, linetype = 5) +
geom_hline(yintercept = 0, linetype = 5) +
ylab("Factors") +
xlab("Productivity") +
labs(color = "Legend") +
coord_fixed() +
theme(legend.position = "bottom")
##theme_bw()
ggsave("figures/rgdpnaPerCapita_TFPvsNonTFP_scatterPlot.pdf", plot = last_plot(),  width = 9, height = 7, units = "in")
ggplot(last_obs, aes(x = cumulativeTFP1990, y = cumulativeNonTFP1990, color = subRegion_new)) +
#geom_point(size = 0, shape = 1) +
geom_text(aes(label = alpha3), size = 2) +
labs(title = "Decomposition of per capita output growth worldwide ") +
labs(subtitle = "1990-2017, annualized, %") +
labs( x= "Average RTFPNA growth", y = "Average non-RTFPNA RGDPNA / capita growth", color = "Legend") +
geom_abline(slope = 1, linetype = 2, size = 0.4) +
geom_abline(slope = -1, intercept = -1, size = 0.4, linetype = 3) +
geom_abline(slope = -1, intercept = 0, size = 0.4, linetype = 3) +
geom_abline(slope = -1, intercept = 1, size = 0.4, linetype = 3) +
geom_abline(slope = -1, intercept = 2, size = 0.4, linetype = 3) +
geom_abline(slope = -1, intercept = 3, size = 0.4, linetype = 3) +
geom_abline(slope = -1, intercept = 4, size = 0.4, linetype = 3) +
geom_abline(slope = -1, intercept = 5, size = 0.4, linetype = 3) +
geom_abline(slope = -1, intercept = 6, size = 0.4, linetype = 3) +
geom_vline(xintercept = 0, linetype = 5) +
geom_hline(yintercept = 0, linetype = 5) +
ylab("Factors") +
xlab("Productivity") +
labs(color = "Legend") +
coord_fixed() +
theme(legend.position = "bottom")
##theme_bw()
ggsave("figures/rgdpnaPerCapita_TFPvsNonTFP_scatterPlot_post1990.pdf", plot = last_plot(),  width = 9, height = 7, units = "in")
### Make Table 1: LAC countries TFP and non-TFP cumulative growth
cumulativeGrowthLAC <- last_obs[ , .(alpha3,subRegion_new,cumulativeTFP,cumulativeNonTFP,cumulativeTFP1990,cumulativeNonTFP1990)][ subRegion_new == "Latin America and the Caribbean"]
newObs <- list("LAC","Latin America and the Caribbean",mean(cumulativeGrowthLAC$cumulativeTFP), mean(cumulativeGrowthLAC$cumulativeNonTFP),
mean(cumulativeGrowthLAC$cumulativeTFP1990), mean(cumulativeGrowthLAC$cumulativeNonTFP1990))
cumulativeGrowthLAC <- rbind(cumulativeGrowthLAC,newObs)
cumulativeGrowthLAC_copy <- copy(cumulativeGrowthLAC)
cumulativeGrowthLAC_copy[ , Total := cumulativeTFP + cumulativeNonTFP]
cumulativeGrowthLAC_copy[ , Total1990 := cumulativeTFP1990 + cumulativeNonTFP1990]
setkey(cumulativeGrowthLAC_copy,alpha3)
cumulativeGrowthLAC <- melt(cumulativeGrowthLAC, id.vars = c("alpha3","subRegion_new"), measure.vars = c("cumulativeTFP","cumulativeNonTFP","cumulativeTFP1990","cumulativeNonTFP1990"))
setkey(cumulativeGrowthLAC,alpha3)
cumulativeGrowthLAC <- cumulativeGrowthLAC_copy[cumulativeGrowthLAC]
ggplot( cumulativeGrowthLAC[variable %in% c("cumulativeTFP","cumulativeNonTFP")], aes(x = reorder(alpha3, Total))) +
geom_bar(stat = "identity", aes(y = value, fill = variable)) +
geom_col(position = position_stack(reverse = TRUE), aes(y = value, fill = variable)) +
geom_point(aes(y = Total, shape = "Total"), size = 2, color = "black") +
xlab("\nCountry") +
ylab("Growth decomposition\n") +
labs(title = "Decomposition of per capita output growth in LAC countries")+
labs(subtitle = "1962-2017, annualized, %") +
scale_fill_discrete(name = "Legend", labels = c("Productivity","Factors")) +
scale_shape_discrete(name = "", labels = "Total") +
coord_flip() +
theme(legend.position = "bottom")
#theme_bw()
ggsave("figures/cumulativeGrowthDecomposition_LAC_barplot.pdf",plot = last_plot(),  width = 9, height = 6.5, units = "in")
ggplot( cumulativeGrowthLAC[variable %in% c("cumulativeTFP1990","cumulativeNonTFP1990")], aes(x = reorder(alpha3, Total1990))) +
geom_bar(stat = "identity", aes(y = value, fill = variable)) +
geom_col(position = position_stack(reverse = TRUE), aes(y = value, fill = variable)) +
geom_point(aes(y = Total1990, shape = "Total"), size = 2, color = "black") +
xlab("\nCountry") +
ylab("Growth decomposition\n") +
labs(title = "Decomposition of per capita output growth in LAC countries")+
labs(subtitle = "1990-2017, annualized, %") +
scale_fill_discrete(name = "Legend", labels = c("Productivity","Factors")) +
scale_shape_discrete(name = "", labels = "Total") +
coord_flip() +
theme(legend.position = "bottom") +
#scale_fill_grey(name = "Legend", labels = c("Productivity","Factors"))
#theme_bw()
ggsave("figures/cumulativeGrowthDecomposition_LAC_barplot_post1990.pdf",plot = last_plot(),  width = 9, height = 6.5, units = "in")
### Make Table 2: LAC average, decomposition of each 8-year period
allPeriodsGrowthLAC_7 <- pwt_7[ subRegion_new == "Latin America and the Caribbean", lapply(.SD[ ,.(lrgdpnaPerCapita_chg7_nonTFP, lrtfpna_chg7)], mean), by = .(year)]
obsMeanPre1990 <- list("Average pre 1990",mean(allPeriodsGrowthLAC_7[year <= 1989]$lrgdpnaPerCapita_chg7_nonTFP), mean(allPeriodsGrowthLAC_7[year <= 1989]$lrtfpna_chg7))
obsMeanPost1990 <- list("Average post 1990",mean(allPeriodsGrowthLAC_7[year > 1989]$lrgdpnaPerCapita_chg7_nonTFP), mean(allPeriodsGrowthLAC_7[year > 1989]$lrtfpna_chg7))
obsMeanAll <- list("Overall average",mean(allPeriodsGrowthLAC_7$lrgdpnaPerCapita_chg7_nonTFP), mean(allPeriodsGrowthLAC_7$lrtfpna_chg7))
allPeriodsGrowthLAC_7 <- rbindlist(list(allPeriodsGrowthLAC_7[1:8,],obsMeanPre1990,obsMeanPost1990,obsMeanAll))
allPeriodsGrowthLAC_7[ , lrgdpnaPerCapita_chg7 := lrgdpnaPerCapita_chg7_nonTFP + lrtfpna_chg7]
## Print to xls
allPeriodsGrowthLAC_7_excel <- allPeriodsGrowthLAC_7
names(allPeriodsGrowthLAC_7_excel) <- c("Period end","Factors","Productivity","Total")
setcolorder(allPeriodsGrowthLAC_7_excel,c("Period end","Productivity","Factors","Total"))
write.xlsx(allPeriodsGrowthLAC_7_excel,"figures/tables/excel/LACgrowthDecomposition.xlsx")
kable(allPeriodsGrowthLAC_7_excel, "latex", booktabs = T, digits = 2, linesep = "", caption = "LAC per capita output growth decomposition.") %>% kable_styling(latex_options = c("hold_position")) %>%
pack_rows("Averages",nrow(allPeriodsGrowthLAC_7_excel)-2,nrow(allPeriodsGrowthLAC_7_excel)) %>% cat(., file = "figures/tables/LACgrowthDecomposition_table.tex")
#table2 <- xtable(allPeriodsGrowthLAC_7_excel,align = c("l","r","r","r","r"), caption = c("LAC output growth decomposition."), caption.placement = "top", digits = 2)
#names(table2) <- c("Period end","non-TFP","TFP","Total")
#print(table2,"figures/tables/LACgrowthDecomposition_table.tex", type = "latex", caption.placement = "top", hline.after = c(-1,0,nrow(table2)-3,nrow(table2)), include.rownames = FALSE, booktabs = TRUE)
# Clean up temporary
#rm(allPeriodsGrowthLAC_7_excel)
## additional: compute correlation
# Correlation of growth rates
cor_rgdpnaPerCapitaGrowth_rtfpnaGrowth <- cor(allPeriodsGrowthLAC_7$lrgdpnaPerCapita_chg7,allPeriodsGrowthLAC_7$lrtfpna_chg7)
cor_rgdpnaPerCapitaGrowth_nonTFPGrowth <- cor(allPeriodsGrowthLAC_7$lrgdpnaPerCapita_chg7,allPeriodsGrowthLAC_7$lrgdpnaPerCapita_chg7_nonTFP)
allPeriodsGrowthLAC_7[ , lrgdpnaPerCapita_chg7_chg := lrgdpnaPerCapita_chg7 - shift(lrgdpnaPerCapita_chg7,n=1L,type="lag")]
allPeriodsGrowthLAC_7[ , lrtfpna_chg7_chg := lrtfpna_chg7 - shift(lrtfpna_chg7,n=1L,type="lag")]
allPeriodsGrowthLAC_7[ , lrgdpnaPerCapita_chg7_nonTFP_chg := lrgdpnaPerCapita_chg7_nonTFP - shift(lrgdpnaPerCapita_chg7_nonTFP,n=1L,type="lag")]
cor_rgdpnaPerCapitaGrowthChg_rtfpnaGrowthChg <- cor(na.omit(allPeriodsGrowthLAC_7$lrgdpnaPerCapita_chg7_chg),na.omit(allPeriodsGrowthLAC_7$lrtfpna_chg7_chg))
cor_rgdpnaPerCapitaGrowthChg_nonTFPGrowthChg <- cor(na.omit(allPeriodsGrowthLAC_7$lrgdpnaPerCapita_chg7_chg),na.omit(allPeriodsGrowthLAC_7$lrgdpnaPerCapita_chg7_nonTFP_chg))
obs1 <- list("RGDPNA per capita growth","RTFPNA growth",cor_rgdpnaPerCapitaGrowth_rtfpnaGrowth)
obs2 <- list("RGDPNA per capita growth","non-RTFPNA growth",cor_rgdpnaPerCapitaGrowth_nonTFPGrowth)
obs3 <- list("RGDPNA per capita growth chg","RTFPNA growth chg",cor_rgdpnaPerCapitaGrowthChg_rtfpnaGrowthChg)
obs4 <- list("RGDPNA per capita growth chg","non-RTFPNA growth chg",cor_rgdpnaPerCapitaGrowthChg_nonTFPGrowthChg)
table2b_correlations_excel <- rbind(obs1,obs2,obs3,obs4)
write.xlsx(table2b_correlations_excel,"figures/tables/excel/LACgrowthDecomposition_correlations.xlsx")
table2b_correlations <- xtable(rbind(obs1,obs2,obs3,obs4), caption = c("RGDPNA per capita growth, and growth changes, are highly correlated with TFP growth, and TFP growth changes. Moreso than with non-TFP growth, growth changes."))
names(table2b_correlations) <- c("Series 1","Series 2","Correlation")
print(table2b_correlations,"figures/tables/LACgrowthDecomposition_correlations_table.tex", type = "latex", include.rownames = FALSE)
## Finally, compare LAC to benchmarks
allPeriodsGrowth_7 <- pwt_7[, lapply(.SD[ ,.(lrgdpnaPerCapita_chg7_nonTFP, lrtfpna_chg7)], mean), by = .(subRegion_new,year)]
allPeriodsGrowth_7[ , lrgdpna_chg7 := lrgdpnaPerCapita_chg7_nonTFP + lrtfpna_chg7]
allPeriodsGrowth_7 <- dcast(allPeriodsGrowth_7, year ~ subRegion_new, value.var = c("lrgdpna_chg7","lrgdpnaPerCapita_chg7_nonTFP","lrtfpna_chg7"))
## Latin America vs Africa
LACvsAfrica <- allPeriodsGrowth_7[ , .(year = year,
lrgdpna_gap = `lrgdpna_chg7_Latin America and the Caribbean` - `lrgdpna_chg7_Africa`, lrgdpna_nonTFP_gap = `lrgdpnaPerCapita_chg7_nonTFP_Latin America and the Caribbean` - `lrgdpnaPerCapita_chg7_nonTFP_Africa`,
lrtfpna_gap = `lrtfpna_chg7_Latin America and the Caribbean` - `lrtfpna_chg7_Africa`)]
pre1990 <- LACvsAfrica[ year <= 1989, lapply(.SD,mean)]
pre1990$year[1] <- "Average pre 1990"
post1990 <- LACvsAfrica[ year > 1989, lapply(.SD,mean)]
post1990$year[1] <- "Average post 1990"
meanAll <- LACvsAfrica[ , lapply(.SD,mean)]
meanAll$year[1] <- "Overall average"
LACvsAfrica <- rbindlist(list(LACvsAfrica[1:8],pre1990,post1990,meanAll))
# Convert to percentage units
#LACvsAfrica[ , c("lrgdpna_gap","lrgdpna_nonTFP_gap","lrtfpna_gap") := lapply(.SD[ , .(lrgdpna_gap,lrgdpna_nonTFP_gap,lrtfpna_gap)], "*",100) ]
names(LACvsAfrica) <- c("Period end","Total","Factors","Productivity")
setcolorder(LACvsAfrica,c("Period end","Productivity","Factors","Total"))
LACvsAFR_raw <- LACvsAfrica
write.xlsx(LACvsAfrica,"figures/tables/excel/LACgrowthDecomposition_benchmark_Africa.xlsx")
kable(LACvsAfrica, "latex", booktabs = T, digits = 2, linesep = "", caption = "LAC per capita output growth gap: Africa benchmark") %>% kable_styling(latex_options = c("hold_position")) %>%
pack_rows("Averages",nrow(LACvsAfrica)-2,nrow(LACvsAfrica)) %>% cat(., file = "figures/tables/LACgrowthDecomposition_benchmark_Africa.tex")
#LACvsAfrica <- xtable(LACvsAfrica,align = c("r","r","r","r","r"), caption = c("LAC growth gap: Africa benchmark"), digits = 2) %>% xtable2kable("latex", booktabs = T) %>% kable_styling(latex_options = "striped") %>%
# pack_rows("Averages",nrow(LACvsAfrica)-3,nrow(LACvsAfrica)) %>% cat(., file = "figures/tables/LACgrowthDecomposition_benchmark_Africa.tex")
#  print(LACvsAfrica,"figures/tables/LACgrowthDecomposition_benchmark_Africa.tex", caption.placement = "top", type = "latex",  booktabs = TRUE, include.rownames = FALSE, size = "\\footnotesize")
## Latin America vs East Asian Tigers
LACvsEAT <- allPeriodsGrowth_7[ , .(year = year,
lrgdpna_gap = `lrgdpna_chg7_Latin America and the Caribbean` - `lrgdpna_chg7_East Asian Tigers`, lrgdpna_nonTFP_gap = `lrgdpnaPerCapita_chg7_nonTFP_Latin America and the Caribbean` - `lrgdpnaPerCapita_chg7_nonTFP_East Asian Tigers`,
lrtfpna_gap = `lrtfpna_chg7_Latin America and the Caribbean` - `lrtfpna_chg7_East Asian Tigers`)]
pre1990 <- LACvsEAT[ year <= 1989, lapply(.SD,mean)]
pre1990$year[1] <- "Average pre 1990"
post1990 <- LACvsEAT[ year > 1989, lapply(.SD,mean)]
post1990$year[1] <- "Average post 1990"
meanAll <- LACvsEAT[ , lapply(.SD,mean)]
meanAll$year[1] <- "Overall average"
LACvsEAT <- rbindlist(list(LACvsEAT[1:8],pre1990,post1990,meanAll))
# Convert to percentage units
#LACvsEAT[ , c("lrgdpna_gap","lrgdpna_nonTFP_gap","lrtfpna_gap") := lapply(.SD[ , .(lrgdpna_gap,lrgdpna_nonTFP_gap,lrtfpna_gap)], "*",100) ]
names(LACvsEAT) <- c("Period end","Total","Factors","Productivity")
setcolorder(LACvsEAT,c("Period end","Productivity","Factors","Total"))
# Store For use later
LACvsEAT_raw <- LACvsEAT
write.xlsx(LACvsEAT,"figures/tables/excel/LACgrowthDecomposition_benchmark_EAT.xlsx")
kable(LACvsEAT, "latex", booktabs = T, digits = 2, linesep = "", caption = "LAC per capita output growth gap: EAT benchmark") %>% kable_styling(latex_options = c("hold_position")) %>%
pack_rows("Averages",nrow(LACvsEAT)-2,nrow(LACvsEAT)) %>% cat(., file = "figures/tables/LACgrowthDecomposition_benchmark_EAT.tex")
#LACvsEAT <- xtable(LACvsEAT,align = c("r","r","r","r","r"), caption = c("LAC vs East Asian Tigers benchmark: RGDPNA per capita growth gap decomposition by 7-yr period and cumulative."), digits = 2)
#print(LACvsEAT,"figures/tables/LACgrowthDecomposition_benchmark_EAT.tex", hline.after = c(-1,0,nrow(LACvsEAT)-3,nrow(LACvsEAT)), type = "latex", booktabs = TRUE, include.rownames = FALSE, size = "\\footnotesize")
## Latin America vs US
LACvsUSA <- allPeriodsGrowth_7[ , .(year = year,
lrgdpna_gap = `lrgdpna_chg7_Latin America and the Caribbean` - `lrgdpna_chg7_United States`, lrgdpna_nonTFP_gap = `lrgdpnaPerCapita_chg7_nonTFP_Latin America and the Caribbean` - `lrgdpnaPerCapita_chg7_nonTFP_United States`,
lrtfpna_gap = `lrtfpna_chg7_Latin America and the Caribbean` - `lrtfpna_chg7_United States`)]
pre1990 <- LACvsUSA[ year <= 1989, lapply(.SD,mean)]
pre1990$year[1] <- "Average pre 1990"
post1990 <- LACvsUSA[ year > 1989, lapply(.SD,mean)]
post1990$year[1] <- "Average post 1990"
meanAll <- LACvsUSA[ , lapply(.SD,mean)]
meanAll$year[1] <-  "Overall average"
LACvsUSA <- rbindlist(list(LACvsUSA[1:8],pre1990,post1990,meanAll))
# Convert to percentage units
#LACvsUSA[ , c("lrgdpna_gap","lrgdpna_nonTFP_gap","lrtfpna_gap") := lapply(.SD[ , .(lrgdpna_gap,lrgdpna_nonTFP_gap,lrtfpna_gap)], "*",100) ]
names(LACvsUSA) <- c("Period end","Total","Factors","Productivity")
setcolorder(LACvsUSA,c("Period end","Productivity","Factors","Total"))
# Store For use later
LACvsUSA_raw <- LACvsUSA
write.xlsx(LACvsUSA,"figures/tables/excel/LACgrowthDecomposition_benchmark_USA.xlsx")
kable(LACvsUSA, "latex", booktabs = T, digits = 2, linesep = "", caption = "LAC per capita output growth gap: USA benchmark") %>% kable_styling(latex_options = c("hold_position")) %>%
pack_rows("Averages",nrow(LACvsUSA)-2,nrow(LACvsUSA)) %>% cat(., file = "figures/tables/LACgrowthDecomposition_benchmark_USA.tex")
#LACvsUSA <- xtable(LACvsUSA,align = c("r","r","r","r","r"), caption = c("LAC vs USA benchmark: RGDPNA per capita growth gap decomposition by 7-yr period and cumulative."), digits = 2)
#print(LACvsUSA,"figures/tables/LACgrowthDecomposition_benchmark_USA.tex", hline.after = c(-1,0,nrow(LACvsUSA)-3,nrow(LACvsUSA)),  type = "latex", booktabs = TRUE, include.rownames = FALSE, size = "\\footnotesize")
### LAC vs non-LAC benchmark
LAC_nonLAC_allPeriodsGrowth_7 <- pwt_7[, lapply(.SD[ ,.(lrgdpnaPerCapita_chg7_nonTFP, lrtfpna_chg7)], mean), by = .(isLAC,year)]
LAC_nonLAC_allPeriodsGrowth_7[ , lrgdpna_chg7 := lrgdpnaPerCapita_chg7_nonTFP + lrtfpna_chg7]
LAC_nonLAC_allPeriodsGrowth_7 <- dcast(LAC_nonLAC_allPeriodsGrowth_7, year ~ isLAC, value.var = c("lrgdpna_chg7","lrgdpnaPerCapita_chg7_nonTFP","lrtfpna_chg7"))
LACvsnonLAC <- LAC_nonLAC_allPeriodsGrowth_7[ , .(year = year,
lrgdpna_gap = `lrgdpna_chg7_1` - `lrgdpna_chg7_0`, lrgdpna_nonTFP_gap = `lrgdpnaPerCapita_chg7_nonTFP_1` - `lrgdpnaPerCapita_chg7_nonTFP_0`,
lrtfpna_gap = `lrtfpna_chg7_1` - `lrtfpna_chg7_0`)]
pre1990 <- LACvsnonLAC[ year <= 1989, lapply(.SD,mean)]
pre1990$year[1] <- "Average pre 1990"
post1990 <- LACvsnonLAC[ year > 1989, lapply(.SD,mean)]
post1990$year[1] <- "Average post 1990"
meanAll <- LACvsnonLAC[ , lapply(.SD,mean)]
meanAll$year[1] <- "Overall average"
LACvsnonLAC <- rbindlist(list(LACvsnonLAC[1:8],pre1990,post1990,meanAll))
# Convert to percentage units
#LACvsnonLAC[ , c("lrgdpna_gap","lrgdpna_nonTFP_gap","lrtfpna_gap") := lapply(.SD[ , .(lrgdpna_gap,lrgdpna_nonTFP_gap,lrtfpna_gap)], "*",100) ]
names(LACvsnonLAC) <- c("Period end","Total","Factors","Productivity")
setcolorder(LACvsnonLAC,c("Period end","Productivity","Factors","Total"))
# Store For use later
LACvsnonLAC_raw <- LACvsnonLAC
write.xlsx(LACvsnonLAC,"figures/tables/excel/LACgrowthDecomposition_benchmark_nonLAC.xlsx")
kable(LACvsnonLAC, "latex", booktabs = T, digits = 2, linesep = "", caption = "LAC per capita output growth gap: non-LAC benchmark") %>% kable_styling(latex_options = c("hold_position")) %>%
pack_rows("Averages",nrow(LACvsnonLAC)-2,nrow(LACvsnonLAC)) %>% cat(., file = "figures/tables/LACgrowthDecomposition_benchmark_nonLAC.tex")
#LACvsnonLAC <- xtable(LACvsnonLAC,align = c("r","r","r","r","r"), caption = c("LAC vs non-LAC benchmark: RGDPNA per capita growth gap decomposition by 7-yr period and cumulative."), digits = 2)
#print(LACvsnonLAC,"figures/tables/LACgrowthDecomposition_benchmark_nonLAC.tex",  hline.after = c(-1,0,nrow(LACvsnonLAC)-3,nrow(LACvsnonLAC)), type = "latex", booktabs = TRUE,  include.rownames = FALSE, size = "\\footnotesize")
###############
##### Make some plots...
#############
### Make Plot: LAC changes in GDP growth vs changes in TFP growth
allPeriodsGrowthLAC_1 <- pwt[ subRegion_new == "Latin America and the Caribbean", lapply(.SD[ ,.(lrgdpnaPerCapita_chg1_nonTFP, lrtfpna_chg1)], mean), by = .(year)]
allPeriodsGrowthLAC_1 <- allPeriodsGrowthLAC_1[order(year)]
allPeriodsGrowthLAC_1[ , lrgdpnaPerCapita_chg1 := lrgdpnaPerCapita_chg1_nonTFP + lrtfpna_chg1]
allPeriodsGrowthLAC_1[ , `:=` (lrgdpnaPerCapita_chg1_nonTFP_chg1 = lrgdpnaPerCapita_chg1_nonTFP - shift(lrgdpnaPerCapita_chg1_nonTFP,n=1L,type = "lag") , lrgdpnaPerCapita_chg1_chg1 = lrgdpnaPerCapita_chg1 - shift(lrgdpnaPerCapita_chg1,n=1L,type = "lag"), lrtfpna_chg1_chg1 = lrtfpna_chg1 - shift(lrtfpna_chg1,n=1L,type = "lag"))]
ggplot(allPeriodsGrowthLAC_1, aes(year)) +
geom_line(aes(y = lrgdpnaPerCapita_chg1_chg1, color = "lrgdpnaPerCapita_chg1_chg1")) +
geom_line(aes(y = lrtfpna_chg1_chg1, color = "lrtfpna_chg1_chg1")) +
ggtitle("1-year chg in growth of rgdpna / capita, rtfpna move together (LAC average)") +
labs(color = "Legend") +
#theme_bw()
ggsave("figures/rgdpnaPerCapitaGrowthChg1_rtfpnaGrowthChg1_LAC_mean.pdf", plot = last_plot())
ggplot(allPeriodsGrowthLAC_1, aes(year)) +
geom_line(aes(y = lrgdpnaPerCapita_chg1_chg1, color = "lrgdpnaPerCapita_chg1_chg1")) +
geom_line(aes(y = lrgdpnaPerCapita_chg1_nonTFP_chg1, color = "lrgdpnaPerCapita_chg1_nonTFP_chg1")) +
ggtitle("1-year chg in growth of rgdpna / capita, non-TFP rgdpna / capita move together, but less (LAC average)") +
labs(color = "Legend") +
#theme_bw()
ggsave("figures/rgdpnaPerCapitaGrowthChg1_rgdpnaPerCapitaGrowthNonTFPChg1_LAC_mean.pdf", plot = last_plot())
allPeriodsGrowthLAC <- pwt[ subRegion_new == "Latin America and the Caribbean", lapply(.SD[ ,.(lrgdpnaPerCapita_chg7_nonTFP, lrtfpna_chg7)], mean), by = .(year)]
allPeriodsGrowthLAC <- allPeriodsGrowthLAC[order(year)]
allPeriodsGrowthLAC[ , lrgdpnaPerCapita_chg7 := lrgdpnaPerCapita_chg7_nonTFP + lrtfpna_chg7]
allPeriodsGrowthLAC[ , `:=` (lrgdpnaPerCapita_chg7_chg1 = lrgdpnaPerCapita_chg7 - shift(lrgdpnaPerCapita_chg7,n=1L,type = "lag") , lrgdpnaPerCapita_chg7_nonTFP_chg1 = lrgdpnaPerCapita_chg7_nonTFP - shift(lrgdpnaPerCapita_chg7_nonTFP,n=1L,type = "lag"), lrtfpna_chg7_chg1 = lrtfpna_chg7 - shift(lrtfpna_chg7,n=1L,type = "lag"))]
ggplot(allPeriodsGrowthLAC, aes(year)) +
geom_line(aes(y = lrgdpnaPerCapita_chg7_chg1, color = "lrgdpnaPerCapita_chg7_chg1")) +
geom_line(aes(y = lrtfpna_chg7_chg1, color = "lrtfpna_chg7_chg1")) +
ggtitle("1-year chg in growth of rgdpna / capita, TFP move together, but less (LAC average, 7-year windows)") +
labs(color = "Legend") +
#theme_bw()
ggsave("figures/rgdpnaPerCapitaGrowth7yrChg1_rtfpnaGrowth7yrChg1_LAC_mean.pdf", plot = last_plot())
ggplot(allPeriodsGrowthLAC, aes(year)) +
geom_line(aes(y = lrgdpnaPerCapita_chg7_chg1, color = "lrgdpnaPerCapita_chg7_chg1")) +
geom_line(aes(y = lrgdpnaPerCapita_chg7_nonTFP_chg1, color = "lrgdpnaPerCapita_chg7_nonTFP_chg1")) +
ggtitle("1-year chg in growth of rgdpna / capita, non-TFP rgdpna / capita move together, but less (LAC average, 7-year windows)") +
labs(color = "Legend") +
#theme_bw()
ggsave("figures/rgdpnaPerCapitaGrowth7yrChg1_rgdpnaPerCapitaGrowth7yrNonTFPChg1_LAC_mean.pdf", plot = last_plot())
# Record 7-year data for use in Stata
# Contruct lag
pwt_7[ , lag_lcgdpoPerCapita_gap_avg7 := shift(lcgdpoPerCapita_gap_avg7, n = 1L, type = "lag"), by = "alpha3"]
# Construct LAC country dummies + nonLAC
#pwt_7[ subRegion_new == "Latin America and the Caribbean", countryLAC := alpha3]
#pwt_7[ is.na(countryLAC), countryLAC := "nonLAC"]
fwrite(pwt_7,"data/pwt_7.csv")
####################
###### Construct expected growth rates for LAC countries using
###### regression based on non-LAC sample. Then compute gaps, and
###### attribute gap to differential LAC convergence vs. other factors
pwt_7 <- fread("data/pwt_7.csv")
regResults <- fread("figures/tables/sec2_mainReg_timeDummies_LACinteractionsAll_nonlagGap_rollingWindows.csv")
regResults2 <- fread("figures/tables/sec2_mainReg_noCountryRegionDummies_rollingWindows.csv")
#regResults_annual <- fread("figures/tables/sec2_mainReg_timeDummies_LACinteractionsAll_nonlagGap_annual.csv")
#regResults2_annual <- fread("figures/tables/sec2_mainReg_noCountryRegionDummies_annual.csv")
# Clean
regResults <- regResults[-1:-2]
regResults <- regResults[-.N]
regResults2 <- regResults2[-1:-2]
regResults2 <- regResults2[-.N]
# Extract constants and add to main dataset
constant <- regResults[53]
constant <- constant[ , .(V2,V3,V4)]
constant2 <- regResults2[52]
constant2 <- constant2[ , .(V2,V3,V4)]
pwt_7[ , constant_tfpGrowth := as.numeric(constant$V2)]
pwt_7[ , constant_nontfpGrowth := as.numeric(constant$V3)]
pwt_7[ , constant_rgdpGrowth := as.numeric(constant$V4)]
pwt_7[ , constant2_tfpGrowth := as.numeric(constant2$V2)]
pwt_7[ , constant2_nontfpGrowth := as.numeric(constant2$V3)]
pwt_7[ , constant2_rgdpGrowth := as.numeric(constant2$V4)]
# Extract RGDP gap coefficients and add to main dataset
rgdpGap <- regResults[1]
rgdpGap2 <- regResults2[1]
pwt_7[ , rgdpGap_tfpGrowth := as.numeric(rgdpGap$V2)]
pwt_7[ , rgdpGap_nontfpGrowth := as.numeric(rgdpGap$V3)]
pwt_7[ , rgdpGap_rgdpGrowth := as.numeric(rgdpGap$V4)]
pwt_7[ , rgdpGap2_tfpGrowth := as.numeric(rgdpGap2$V2)]
pwt_7[ , rgdpGap2_nontfpGrowth := as.numeric(rgdpGap2$V3)]
pwt_7[ , rgdpGap2_rgdpGrowth := as.numeric(rgdpGap2$V4)]
# Extract time dummy coefficients and link to main dataset
timeDummies <- regResults[3:52]
names(timeDummies) <- c("year","timeDummy_tfpGrowth","timeDummy_nontfpGrowth","timeDummy_rgdpGrowth")
timeDummies[ , year := as.numeric(substr(year,6,9))]
timeDummies2 <- regResults2[2:51]
names(timeDummies2) <- c("year","timeDummy2_tfpGrowth","timeDummy2_nontfpGrowth","timeDummy2_rgdpGrowth")
timeDummies2[ , year := as.numeric(substr(year,6,9))]
setkey(timeDummies,year)
setkey(pwt_7,year)
pwt_7 <- timeDummies[pwt_7]
setkey(timeDummies2,year)
pwt_7 <- timeDummies2[pwt_7]
View(timeDummies2)
pwt_7[ , predicted_rgdpGrowth := constant_rgdpGrowth + as.numeric(timeDummy_rgdpGrowth) + lcgdpoPerCapita_gap_avg7 * rgdpGap_rgdpGrowth]
pwt_7[ , predicted_tfpGrowth := constant_tfpGrowth + as.numeric(timeDummy_tfpGrowth) + lcgdpoPerCapita_gap_avg7 * rgdpGap_tfpGrowth]
pwt_7[ , predicted_nontfpGrowth := constant_nontfpGrowth + as.numeric(timeDummy_nontfpGrowth) + lcgdpoPerCapita_gap_avg7 * rgdpGap_nontfpGrowth]
pwt_7[ , predicted2_rgdpGrowth := constant2_rgdpGrowth + as.numeric(timeDummy2_rgdpGrowth) + lcgdpoPerCapita_gap_avg7 * rgdpGap2_rgdpGrowth]
pwt_7[ , predicted2_tfpGrowth := constant2_tfpGrowth + as.numeric(timeDummy2_tfpGrowth) + lcgdpoPerCapita_gap_avg7 * rgdpGap2_tfpGrowth]
pwt_7[ , predicted2_nontfpGrowth := constant2_nontfpGrowth + as.numeric(timeDummy2_nontfpGrowth) + lcgdpoPerCapita_gap_avg7 * rgdpGap2_nontfpGrowth]
pwt_7[ , rgdpGrowthGap := lrgdpnaPerCapita_chg7 - predicted_rgdpGrowth]
pwt_7[ , tfpGrowthGap := lrtfpna_chg7 - predicted_tfpGrowth]
pwt_7[ , nontfpGrowthGap := lrgdpnaPerCapita_chg7_nonTFP - predicted_nontfpGrowth]
pwt_7[ , rgdpGrowthGap2 := lrgdpnaPerCapita_chg7 - predicted2_rgdpGrowth]
pwt_7[ , tfpGrowthGap2 := lrtfpna_chg7 - predicted2_tfpGrowth]
pwt_7[ , nontfpGrowthGap2 := lrgdpnaPerCapita_chg7_nonTFP - predicted2_nontfpGrowth]
## Calculating average gaps by region :
# Version 1
LACaverageGaps <- pwt_7[subRegion_new == "Latin America and the Caribbean"][ , lapply(.SD[ , .(rgdpGrowthGap,tfpGrowthGap,nontfpGrowthGap)],mean), by = year]
EATaverageGaps <- pwt_7[subRegion_new == "East Asian Tigers"][ , lapply(.SD[ , .(rgdpGrowthGap,tfpGrowthGap,nontfpGrowthGap)],mean), by = year]
AFRaverageGaps <- pwt_7[subRegion_new == "Africa"][ , lapply(.SD[ , .(rgdpGrowthGap,tfpGrowthGap,nontfpGrowthGap)],mean), by = year]
USAaverageGaps <- pwt_7[subRegion_new == "United States"][ , lapply(.SD[ , .(rgdpGrowthGap,tfpGrowthGap,nontfpGrowthGap)],mean), by = year]
# Check that they're zero as verification that my procedure is correctly implemented
NONLACaverageGaps <- pwt_7[subRegion_new != "Latin America and the Caribbean"][ , lapply(.SD[ , .(rgdpGrowthGap,tfpGrowthGap,nontfpGrowthGap)],mean), by = year]
# Version 2
LACaverageGaps2 <- pwt_7[subRegion_new == "Latin America and the Caribbean"][ , lapply(.SD[ , .(rgdpGrowthGap2,tfpGrowthGap2,nontfpGrowthGap2)],mean), by = year]
NONLACaverageGaps2 <- pwt_7[subRegion_new != "Latin America and the Caribbean"][ , lapply(.SD[ , .(rgdpGrowthGap2,tfpGrowthGap2,nontfpGrowthGap2)],mean), by = year]
EATaverageGaps2 <- pwt_7[subRegion_new == "East Asian Tigers"][ , lapply(.SD[ , .(rgdpGrowthGap2,tfpGrowthGap2,nontfpGrowthGap2)],mean), by = year]
AFRaverageGaps2 <- pwt_7[subRegion_new == "Africa"][ , lapply(.SD[ , .(rgdpGrowthGap2,tfpGrowthGap2,nontfpGrowthGap2)],mean), by = year]
USAaverageGaps2 <- pwt_7[subRegion_new == "United States"][ , lapply(.SD[ , .(rgdpGrowthGap2,tfpGrowthGap2,nontfpGrowthGap2)],mean), by = year]
# rename for merging
names(EATaverageGaps) <- c("year","EATrgdpGrowthGap","EATtfpGrowthGap","EATnontfpGrowthGap")
names(AFRaverageGaps) <- c("year","AFRrgdpGrowthGap","AFRtfpGrowthGap","AFRnontfpGrowthGap")
names(USAaverageGaps) <- c("year","USArgdpGrowthGap","USAtfpGrowthGap","USAnontfpGrowthGap")
names(LACaverageGaps2) <- c("year","LACrgdpGrowthGap2","LACtfpGrowthGap2","LACnontfpGrowthGap2")
names(EATaverageGaps2) <- c("year","EATrgdpGrowthGap2","EATtfpGrowthGap2","EATnontfpGrowthGap2")
names(AFRaverageGaps2) <- c("year","AFRrgdpGrowthGap2","AFRtfpGrowthGap2","AFRnontfpGrowthGap2")
names(USAaverageGaps2) <- c("year","USArgdpGrowthGap2","USAtfpGrowthGap2","USAnontfpGrowthGap2")
names(NONLACaverageGaps2) <- c("year","NONLACrgdpGrowthGap2","NONLACtfpGrowthGap2","NONLACnontfpGrowthGap2")
View(NONLACaverageGaps)
View(NONLACaverageGaps2)
View(NONLACaverageGaps)
View(NONLACaverageGaps2)
View(NONLACaverageGaps)
View(LACaverageGaps)
View(NONLACaverageGaps2)
View(NONLACaverageGaps2)
View(NONLACaverageGaps)
View(LACaverageGaps)
library(plm)
library(sandwich)
data <- fread("data/pwt91_cleaned_swiid.csv")
setkey(data,alpha3,year)
data <- data[ year >= 1968]
data[ , gini_disp := (1/7) * Reduce(`+`, shift(gini_disp, n = 0L:6L, type = "lag")), by = .(alpha3)]
data[ , gini_mkt := (1/7) * Reduce(`+`, shift(gini_mkt, n = 0L:6L, type = "lag")), by = .(alpha3)]
data[ !is.na(gini_disp), hasGiniDisp := 1]
data[ is.na(gini_disp), hasGiniDisp := 0]
data[ !is.na(gini_mkt), hasGiniMkt := 1]
data[ is.na(gini_mkt), hasGiniMkt := 0]
## Country residuals
#data <- data[ hasGiniDisp == 1 & hasGiniMkt == 1]
# Turn countryLAC into factor variable (so can choose reference group)
data[ , countryLAC := relevel(factor(countryLAC),"nonLAC")]
# Adjusting for stage of development
rtfpModel <- plm(lrtfpna_chg7 ~ lcgdpoPerCapita_gap_avg7 + countryLAC, data, effect = "time", model = "within")
nonTfpModel <- plm(lrgdpnaPerCapita_chg7_nonTFP ~ lcgdpoPerCapita_gap_avg7 + countryLAC, data, effect = "time", model = "within")
rgdpnaPerCapitaModel <- plm(lrgdpnaPerCapita_chg7 ~ lcgdpoPerCapita_gap_avg7 + countryLAC, data, effect = "time", model = "within")
rtfpModelCoefs <- cbind(names(coefficients(rtfpModel)),data.table(summary(rtfpModel)$coefficients))[2:.N]
nonTfpModelCoefs <- cbind(names(coefficients(nonTfpModel)),data.table(summary(nonTfpModel)$coefficients))[2:.N]
rgdpnaPerCapitaModelCoefs <- cbind(names(coefficients(rgdpnaPerCapitaModel)),data.table(summary(rgdpnaPerCapitaModel)$coefficients))[2:.N]
rtfpModelCoefs[ , V1 := substr(V1,11,13)]
nonTfpModelCoefs[ , V1 := substr(V1,11,13)]
rgdpnaPerCapitaModelCoefs[ , V1 := substr(V1,11,13)]
setnames(rtfpModelCoefs,"Estimate","rtfpModelCountryDummy")
setnames(nonTfpModelCoefs,"Estimate","nonTfpModelCountryDummy")
setnames(rgdpnaPerCapitaModelCoefs,"Estimate","rgdpnaPerCapitaModelCountryDummy")
setkey(rtfpModelCoefs,V1)
setkey(nonTfpModelCoefs,V1)
setkey(rgdpnaPerCapitaModelCoefs,V1)
setkey(data,alpha3)
data <- rtfpModelCoefs[ , .(V1,rtfpModelCountryDummy)][data]
setkey(data,V1)
data <- nonTfpModelCoefs[ , .(V1,nonTfpModelCountryDummy)][data]
data <- rgdpnaPerCapitaModelCoefs[ , .(V1,rgdpnaPerCapitaModelCountryDummy)][data]
setnames(data,"V1","alpha3")
data[ , rtfpModelResid := resid(rtfpModel) + rtfpModelCountryDummy]
data[ , nonTfpModelResid := resid(nonTfpModel) + nonTfpModelCountryDummy]
data[ , rgdpnaPerCapitaModelResid := resid(rgdpnaPerCapitaModel) + rgdpnaPerCapitaModelCountryDummy]
data[ , rtfpModelResidAvg := mean(na.omit(resid(rtfpModel))), by = .(countryLAC,year), ]
View(data)
library(plm)
library(sandwich)
data <- fread("data/pwt91_cleaned_swiid.csv")
setkey(data,alpha3,year)
data <- data[ year >= 1968]
data[ , gini_disp := (1/7) * Reduce(`+`, shift(gini_disp, n = 0L:6L, type = "lag")), by = .(alpha3)]
data[ , gini_mkt := (1/7) * Reduce(`+`, shift(gini_mkt, n = 0L:6L, type = "lag")), by = .(alpha3)]
data[ !is.na(gini_disp), hasGiniDisp := 1]
data[ is.na(gini_disp), hasGiniDisp := 0]
data[ !is.na(gini_mkt), hasGiniMkt := 1]
data[ is.na(gini_mkt), hasGiniMkt := 0]
## Country residuals
#data <- data[ hasGiniDisp == 1 & hasGiniMkt == 1]
# Turn countryLAC into factor variable (so can choose reference group)
data[ , countryLAC := relevel(factor(countryLAC),"nonLAC")]
# Adjusting for stage of development
rtfpModel <- plm(lrtfpna_chg7 ~ lcgdpoPerCapita_gap_avg7 + countryLAC, data, effect = "time", model = "within")
nonTfpModel <- plm(lrgdpnaPerCapita_chg7_nonTFP ~ lcgdpoPerCapita_gap_avg7 + countryLAC, data, effect = "time", model = "within")
rgdpnaPerCapitaModel <- plm(lrgdpnaPerCapita_chg7 ~ lcgdpoPerCapita_gap_avg7 + countryLAC, data, effect = "time", model = "within")
rtfpModelCoefs <- cbind(names(coefficients(rtfpModel)),data.table(summary(rtfpModel)$coefficients))[2:.N]
nonTfpModelCoefs <- cbind(names(coefficients(nonTfpModel)),data.table(summary(nonTfpModel)$coefficients))[2:.N]
rgdpnaPerCapitaModelCoefs <- cbind(names(coefficients(rgdpnaPerCapitaModel)),data.table(summary(rgdpnaPerCapitaModel)$coefficients))[2:.N]
rtfpModelCoefs[ , V1 := substr(V1,11,13)]
nonTfpModelCoefs[ , V1 := substr(V1,11,13)]
rgdpnaPerCapitaModelCoefs[ , V1 := substr(V1,11,13)]
setnames(rtfpModelCoefs,"Estimate","rtfpModelCountryDummy")
setnames(nonTfpModelCoefs,"Estimate","nonTfpModelCountryDummy")
setnames(rgdpnaPerCapitaModelCoefs,"Estimate","rgdpnaPerCapitaModelCountryDummy")
setkey(rtfpModelCoefs,V1)
setkey(nonTfpModelCoefs,V1)
setkey(rgdpnaPerCapitaModelCoefs,V1)
setkey(data,alpha3)
data <- rtfpModelCoefs[ , .(V1,rtfpModelCountryDummy)][data]
setkey(data,V1)
data <- nonTfpModelCoefs[ , .(V1,nonTfpModelCountryDummy)][data]
data <- rgdpnaPerCapitaModelCoefs[ , .(V1,rgdpnaPerCapitaModelCountryDummy)][data]
setnames(data,"V1","alpha3")
data[ , rtfpModelResid := resid(rtfpModel) + rtfpModelCountryDummy]
data[ , nonTfpModelResid := resid(nonTfpModel) + nonTfpModelCountryDummy]
data[ , rgdpnaPerCapitaModelResid := resid(rgdpnaPerCapitaModel) + rgdpnaPerCapitaModelCountryDummy]
data[ , rtfpModelResidAvg := mean(na.omit(resid(rtfpModel))), by = .(countryLAC,year)]
View(data)
setkey(data,alpha3,year)
data[ , rtfpModelResidAvg := mean(na.omit(resid(rtfpModel))), by = .(countryLAC,year)]
View(data)
View(LACaverageGaps)
library(plm)
library(sandwich)
data <- fread("data/pwt91_cleaned_swiid.csv")
setkey(data,alpha3,year)
data <- data[ year >= 1968]
data[ , gini_disp := (1/7) * Reduce(`+`, shift(gini_disp, n = 0L:6L, type = "lag")), by = .(alpha3)]
data[ , gini_mkt := (1/7) * Reduce(`+`, shift(gini_mkt, n = 0L:6L, type = "lag")), by = .(alpha3)]
data[ !is.na(gini_disp), hasGiniDisp := 1]
data[ is.na(gini_disp), hasGiniDisp := 0]
data[ !is.na(gini_mkt), hasGiniMkt := 1]
data[ is.na(gini_mkt), hasGiniMkt := 0]
## Country residuals
#data <- data[ hasGiniDisp == 1 & hasGiniMkt == 1]
# Turn countryLAC into factor variable (so can choose reference group)
data[ , countryLAC := relevel(factor(countryLAC),"nonLAC")]
# Adjusting for stage of development
rtfpModel <- plm(lrtfpna_chg7 ~ lcgdpoPerCapita_gap_avg7 + countryLAC, data, effect = "time", model = "within")
nonTfpModel <- plm(lrgdpnaPerCapita_chg7_nonTFP ~ lcgdpoPerCapita_gap_avg7 + countryLAC, data, effect = "time", model = "within")
rgdpnaPerCapitaModel <- plm(lrgdpnaPerCapita_chg7 ~ lcgdpoPerCapita_gap_avg7 + countryLAC, data, effect = "time", model = "within")
rtfpModelCoefs <- cbind(names(coefficients(rtfpModel)),data.table(summary(rtfpModel)$coefficients))[2:.N]
nonTfpModelCoefs <- cbind(names(coefficients(nonTfpModel)),data.table(summary(nonTfpModel)$coefficients))[2:.N]
rgdpnaPerCapitaModelCoefs <- cbind(names(coefficients(rgdpnaPerCapitaModel)),data.table(summary(rgdpnaPerCapitaModel)$coefficients))[2:.N]
rtfpModelCoefs[ , V1 := substr(V1,11,13)]
nonTfpModelCoefs[ , V1 := substr(V1,11,13)]
rgdpnaPerCapitaModelCoefs[ , V1 := substr(V1,11,13)]
setnames(rtfpModelCoefs,"Estimate","rtfpModelCountryDummy")
setnames(nonTfpModelCoefs,"Estimate","nonTfpModelCountryDummy")
setnames(rgdpnaPerCapitaModelCoefs,"Estimate","rgdpnaPerCapitaModelCountryDummy")
setkey(rtfpModelCoefs,V1)
setkey(nonTfpModelCoefs,V1)
setkey(rgdpnaPerCapitaModelCoefs,V1)
setkey(data,alpha3)
data <- rtfpModelCoefs[ , .(V1,rtfpModelCountryDummy)][data]
setkey(data,V1)
data <- nonTfpModelCoefs[ , .(V1,nonTfpModelCountryDummy)][data]
data <- rgdpnaPerCapitaModelCoefs[ , .(V1,rgdpnaPerCapitaModelCountryDummy)][data]
setnames(data,"V1","alpha3")
data[ , rtfpModelResid := resid(rtfpModel) + rtfpModelCountryDummy]
data[ , nonTfpModelResid := resid(nonTfpModel) + nonTfpModelCountryDummy]
data[ , rgdpnaPerCapitaModelResid := resid(rgdpnaPerCapitaModel) + rgdpnaPerCapitaModelCountryDummy]
setkey(data,alpha3,year)
data[ , rtfpModelResidAvg := resid(rtfpModel)]
data[ , rtfpModelResidAvg := mean(na.omit(rtfpModelResidAvg)), by = .(countryLAC,year)]
View(data)
data[ , rtfpModelResidAvg := mean(na.omit(rtfpModelResidAvg)), by = .(isLAC,year)]
View(data)
temp <- data[ , .(isLAC,year,rtfpModelResidAvg)]
ggplot(temp, aes(x = year, y = rtfpModelResidAvg, linetype = isLAC)) + geom_line()
ggplot(temp, aes(x = year, y = rtfpModelResidAvg, linetype = factor(isLAC))) + geom_line()
